<% provide :page_title, "Resultat de recherche"  %>

<section class="container-fluid py-4" style="background-color: #FAFAFA;">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h4>Afinner votre recherche</h4>
                <%= render "shareds/property_search_form" %>
                <p>Je vais ajouter un form avancé ici pour (range prix, range surface, nombre de pièce</p>
            </div>
        </div>
    </div>
</section>

<section class="container-fluid py-4">
    <div class="container">
        <div class="row">
            <% if @properties.present? %>
            <div class="col-12">
                <p><%= pluralize(@properties_numbers, "annonce trouvé", "annonces trouvés")  %></p>


                <!-- <%# if @properties_numbers > 1 %>
                <p><%= @properties_numbers %> annonces trouvés</p>
                <#% else %>
                <p><%= @properties_numbers %> annonce trouvé</p>
                <%# end %> -->
            </div>

            <% @properties.each do |property| %>
            <div class="col-lg-4">
                <%= link_to property, class: "sans-text-decoration" do %>
                <div class="card mb-4 liste-card-recherche text-dark">
                    <%= image_tag property.property_photos.first.photo_url, class: "card-img-top", alt: "Photo de #{ property.title }", height: "200px" %>
                    <% if property.ad_type.name == "Vente" %>
                    <span class="position-absolute badge badge-secondary p-2" style="top: 15px; left: 15px;">A vendre</span>
                    <% elsif property.ad_type.name == "Location" %>
                    <span class="position-absolute badge badge-secondary p-2" style="top: 15px; left: 15px;">A louer</span>
                    <% end %>
                    <div class="card-body p-3">
                        <h5 class="card-title">
                            <%= truncate(strip_tags(property.title.capitalize), length: 25) %>
                        </h5>
                        <address class="card-text">
                            <i class="fas fa-map-marker-alt"></i>&nbsp; <%= property.address %>, <%= property.city %>
                        </address>
                        <% if property.ad_type.name == "Vente" %>
                        <p class="text-primary m-0 p-0 h3">
                            <%= number_with_delimiter(sprintf("%0.00f", property.price)) %><sup>f</sup>
                        </p>
                        <% elsif property.ad_type.name == "Location" %>
                        <p class="text-primary m-0 p-0 h3">
                            <%= number_with_delimiter(sprintf("%0.00f", property.price)) %><sup>f</sup>/<small>mois</small></sup>
                        </p>
                        <% end %>
                        <hr>
                        <p class="m-0 ">
                            <small>Publié le <%= property.created_at.strftime("%e %B") %></small>
                            <small class="sr-only">Il y a <%= time_ago_in_words(property.created_at) %></small>
                        </p>
                    </div>
                </div>
                <% end %>
            </div>
            <% end %>
            <% else %>
            <p>Aucun résultat trouvé !</p>
            <% end %>
            <div class="col-12">
                <p class="m-0"><%= paginate @properties, :theme => 'twitter-bootstrap' %></p>
            </div>
        </div>
    </div>
</section>
