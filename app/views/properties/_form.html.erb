<% if @ad_type == "A louer" %>
<%= simple_form_for(@property) do |f| %>
<%= f.error_notification %>
<% if @property.errors.any? %>
<div class="alert alert-danger" role="alert">
    <p>
        <%= pluralize(@property.errors.count, "erreur", "erreurs") %> ont empêché l'enregistrement de cet annonce:
    </p>
    <ul>
        <% @property.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
        <% end %>
    </ul>
</div>
<% end %>
<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Description du bien</h4>
            </div>
            <div class="col-lg-12">
                <%= f.input :ad_type, as: :hidden, input_html: { value: @ad_type } %>
            </div>
            <div class="col-lg-12">
                <%= f.input :property_type, as: :radio_buttons, collection: Property::PROPERTY_TYPE_FOR_RENT, wrapper: :horizontal_collection_inline %>
            </div>
            <div class="col-12">
                <%= f.input :title %>
            </div>
            <div class="col-12">
                <%= f.input :description, input_html: { rows: 10 } %>
            </div>
            <div class="col-md-4">
                <%= f.input :room, collection: Property::ROOM %>
            </div>
            <div class="col-md-4">
             <%= f.input :area, input_html: { min: 1 }, label: "Surface du bien (m2)" %>
         </div>
         <div class="col-md-4">
            <%= f.input :available, collection: Property::AVAILABLE %>
        </div>
        <div class="col-md-4">
            <%= f.input :etage, collection: Property::ETAGE %>
        </div>
        <div class="col-md-4">
            <%= f.input :price, input_html: { min: 1 } %>
        </div>
        <div class="col-md-4">
            <%= f.input :deposit, input_html: { min: 1 }, label: "Avance (nombres de mois ?)" %>
        </div>
    </div>
</div>
</div>

<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Caractéristiques du bien</h4>
            </div>
            <div class="col-12">
                <%= f.input :feature, as: :check_boxes, collection: Property::FEATURE, wrapper: :horizontal_collection_inline %>
            </div>
        </div>
    </div>
</div>

<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Photos du bien</h4>
                <p class="card-text text-info mb-4">
                    <small>Une annonce avec photo est 7 fois plus consultée qu'une annonce sans photo. <br> Ajouter les photos des différents pièces et de bonne qualité afin d'attirer plus de locataires potentiels.</small>
                </p>
            </div>
            <div class="col-md-12">
            <% 4.times do |i| %>
                <%= f.input :images, as: :file, label: "Photo #{i + 1 }", input_html: { name: "property[images][]", class: "form-control-file"}, direct_upload: true, wrapper: :horizontal_file %>
                 <% if current_page? "properties/#{:id}/edit" %>
                    <%= image_tag url_for(@property.images["#{i}".to_i]), size: "200x150" if @property.images["#{i}".to_i].present? %>
                <% end %>
            <% end %>
            </div>
        </div>
    </div>
</div>

<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Localisation du bien</h4>
            </div>
            <div class="col-md-6 sr-only">
                <%= f.input :address %>
            </div>
            <div class="col-md-6">
                <%= f.input :city %>
            </div>
        </div>
    </div>
</div>

<% if user_signed_in? %>
<% if current_user.first_name.blank? && current_user.last_name.blank? && current_user.phone_number.blank? %>
<%= f.simple_fields_for :user do |user_info| %>
<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Information de contact</h4>
            </div>
            <div class="col-md-6">
                <%= user_info.input :first_name, label: "Prénom" %>
            </div>
            <div class="col-md-6">
                <%= user_info.input :last_name, label: "Nom" %>
            </div>
            <div class="col-md-6">
                <%= user_info.input :phone_number, as: :tel, label: "Numéro de téléphone" %>
            </div>
        </div>
    </div>
</div>
<% end %>
<% end %>
<% end %>

<div class="form-row">
    <div class="col-12">
        <%= f.button :submit, @property.persisted? ? "Modifier l'annonce" : "Publiez l'annonce" , class: "btn btn-primary btn-lg" %>
    </div>
</div>
<% end %>


<% elsif @ad_type == "A vendre" %>
<%= simple_form_for(@property) do |f| %>
<%= f.error_notification %>
<% if @property.errors.any? %>
<div class="alert alert-danger" role="alert">
    <p>
        <%= pluralize(@property.errors.count, "erreur", "erreurs") %> ont empêché l'enregistrement de cet annonce:
    </p>
    <ul>
        <% @property.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
        <% end %>
    </ul>
</div>
<% end %>

<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Description du bien</h4>
            </div>
            <div class="col-lg-12">
                <%= f.input :ad_type, as: :hidden, input_html: { value: @ad_type } %>
            </div>
            <div class="col-lg-12">
                <%= f.input :property_type, as: :radio_buttons, collection: Property::PROPERTY_TYPE_FOR_SELL, wrapper: :horizontal_collection_inline %>
            </div>
            <div class="col-12">
                <%= f.input :title %>
            </div>
            <div class="col-12">
                <%= f.input :description, input_html: { rows: 10 } %>
            </div>
            <div class="col-md-4">
             <%= f.input :area, input_html: { min: 1 }, label: "Surface du bien (m2)", required: true %>
         </div>
         <div class="col-md-4">
                <%= f.input :room, collection: Property::ROOM %>
            </div>
        <div class="col-md-4">
            <%= f.input :price, input_html: { min: 1 }, label: "Prix" %>
        </div>
    </div>
</div>
</div>

<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Caractéristiques du bien</h4>
            </div>
            <div class="col-12">
                <%= f.input :feature, as: :check_boxes, collection: Property::FEATURE, wrapper: :horizontal_collection_inline %>
            </div>
        </div>
    </div>
</div>

<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Photos du bien</h4>
                <p class="card-text text-info mb-4">
                    <small>Une annonce avec photo est 7 fois plus consultée qu'une annonce sans photo. <br> Ajouter les photos des différents pièces et de bonne qualité afin d'attirer plus de locataires potentiels.</small>
                </p>
            </div>
            <div class="col-md-12">
            <% 4.times do |i| %>
                <%= f.input :images, as: :file, label: "Photo #{i + 1 }", input_html: { name: "property[images][]", class: "form-control-file"}, direct_upload: true, wrapper: :horizontal_file %>
                 <% if current_page? "properties/#{:id}/edit" %>
                    <%= image_tag url_for(@property.images["#{i}".to_i]), size: "200x150" if @property.images["#{i}".to_i].present? %>
                <% end %>
            <% end %>
            </div>
        </div>
    </div>
</div>

<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Localisation du bien</h4>
            </div>
            <div class="col-md-6 sr-only">
                <%= f.input :address %>
            </div>
            <div class="col-md-6">
                <%= f.input :city %>
            </div>
        </div>
    </div>
</div>

<% if user_signed_in? %>
<% if current_user.first_name.blank? && current_user.last_name.blank? && current_user.phone_number.blank? %>
<%= f.simple_fields_for :user do |user_info| %>
<div class="card border-0 mb-4 mon-box-shadow">
    <div class="card-body">
        <div class="form-row p-2">
            <div class="col-12">
                <h4 class="card-title mb-3">Information de contact</h4>
            </div>
            <div class="col-md-6">
                <%= user_info.input :first_name, label: "Prénom" %>
            </div>
            <div class="col-md-6">
                <%= user_info.input :last_name, label: "Nom" %>
            </div>
            <div class="col-md-6">
                <%= user_info.input :phone_number, as: :tel, label: "Numéro de téléphone" %>
            </div>
        </div>
    </div>
</div>
<% end %>
<% end %>
<% end %>

<div class="form-row">
    <div class="col-12">
        <%= f.button :submit, @property.persisted? ? "Modifier l'annonce" : "Publiez l'annonce" , class: "btn btn-primary btn-lg" %>
    </div>
</div>
<% end %>

<% end %>